{
    "componentChunkName": "component---src-templates-md-blog-post-js",
    "path": "/posts/2021-02-28-aero-ctf-2021-phoenix",
    "result": {"data":{"markdownRemark":{"html":"<h1>phoenix</h1>\n<blockquote>\n<p>If you want to become a member of the Order of the Phoenix, you need to:</p>\n<p>be able to perfectly control the magic wand\nbe able to crack the following cipher</p>\n<p>...but maybe some of this is not needed</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token comment\">#!/usr/bin/env sage</span>\n\np <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\nF <span class=\"token operator\">=</span> GF<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span>\nP<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>x<span class=\"token operator\">></span> <span class=\"token operator\">=</span> PolynomialRing<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Cipher</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> size\n        self<span class=\"token punctuation\">.</span>params <span class=\"token operator\">=</span> params\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">sequence</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n            key <span class=\"token operator\">=</span> key <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">yield</span> key <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> strength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> value<span class=\"token punctuation\">,</span> pbit <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>sequence<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            xbit <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> strength<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            ybit <span class=\"token operator\">=</span> mul<span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> strength<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            \n            <span class=\"token keyword\">yield</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>pbit<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span><span class=\"token operator\">^</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>xbit<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span><span class=\"token operator\">^</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>ybit<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    size <span class=\"token operator\">=</span> <span class=\"token number\">256</span>\n    length <span class=\"token operator\">=</span> <span class=\"token number\">1024</span>\n    strength <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n\n    q <span class=\"token operator\">=</span> P<span class=\"token punctuation\">.</span>irreducible_element<span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">,</span> <span class=\"token string\">'minimal_weight'</span><span class=\"token punctuation\">)</span>\n    R<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>x<span class=\"token operator\">></span> <span class=\"token operator\">=</span> P<span class=\"token punctuation\">.</span>quo<span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span>\n\n    key<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>R<span class=\"token punctuation\">.</span>random_element<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'flag.txt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span>\n        flag <span class=\"token operator\">=</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    message <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">.</span>from_bytes<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> <span class=\"token string\">'big'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">assert</span> message<span class=\"token punctuation\">.</span>bit_length<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> size\n    plaintext <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bin</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    padding <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>length <span class=\"token operator\">-</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>plaintext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    cipher <span class=\"token operator\">=</span> Cipher<span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    ciphertext <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>cipher<span class=\"token punctuation\">.</span>encrypt<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> padding <span class=\"token operator\">+</span> plaintext<span class=\"token punctuation\">,</span> strength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    result <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> ciphertext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">x^255 + x^252 + x^246 + x^245 + x^240 + x^239 + x^236 + x^234 + x^233 + x^232 + x^231 + x^229 + x^228 + x^227 + x^224 + x^223 + x^218 + x^217 + x^216 + x^215 + x^210 + x^209 + x^204 + x^202 + x^200 + x^198 + x^197 + x^196 + x^192 + x^188 + x^187 + x^182 + x^181 + x^180 + x^178 + x^177 + x^176 + x^174 + x^173 + x^172 + x^167 + x^166 + x^161 + x^160 + x^157 + x^155 + x^154 + x^151 + x^150 + x^149 + x^148 + x^147 + x^146 + x^144 + x^140 + x^137 + x^135 + x^133 + x^132 + x^130 + x^129 + x^126 + x^122 + x^119 + x^118 + x^115 + x^112 + x^111 + x^109 + x^107 + x^106 + x^105 + x^104 + x^101 + x^100 + x^99 + x^97 + x^96 + x^94 + x^92 + x^87 + x^86 + x^84 + x^83 + x^81 + x^79 + x^75 + x^71 + x^69 + x^68 + x^67 + x^66 + x^65 + x^63 + x^62 + x^61 + x^56 + x^55 + x^53 + x^52 + x^50 + x^46 + x^44 + x^43 + x^41 + x^39 + x^38 + x^37 + x^36 + x^35 + x^34 + x^33 + x^32 + x^30 + x^29 + x^27 + x^24 + x^21 + x^17 + x^16 + x^14 + x^13 + x^12 + x^11 + x^10 + x^9 + x^5 + x^4 + x^3 + x + 1\nx^255 + x^254 + x^250 + x^247 + x^243 + x^242 + x^241 + x^238 + x^235 + x^232 + x^229 + x^227 + x^222 + x^221 + x^219 + x^218 + x^217 + x^216 + x^215 + x^211 + x^207 + x^206 + x^204 + x^202 + x^201 + x^197 + x^195 + x^193 + x^192 + x^190 + x^189 + x^188 + x^186 + x^184 + x^181 + x^180 + x^179 + x^178 + x^176 + x^173 + x^172 + x^169 + x^167 + x^165 + x^161 + x^160 + x^158 + x^149 + x^147 + x^146 + x^145 + x^140 + x^138 + x^137 + x^134 + x^133 + x^132 + x^130 + x^129 + x^128 + x^126 + x^125 + x^124 + x^121 + x^120 + x^118 + x^117 + x^114 + x^112 + x^111 + x^110 + x^109 + x^108 + x^107 + x^106 + x^105 + x^101 + x^96 + x^95 + x^94 + x^93 + x^92 + x^90 + x^89 + x^88 + x^86 + x^85 + x^84 + x^83 + x^81 + x^80 + x^79 + x^78 + x^77 + x^76 + x^71 + x^70 + x^69 + x^68 + x^67 + x^64 + x^63 + x^59 + x^56 + x^55 + x^53 + x^50 + x^46 + x^43 + x^42 + x^40 + x^38 + x^37 + x^35 + x^34 + x^33 + x^25 + x^23 + x^22 + x^21 + x^18 + x^16 + x^14 + x^13 + x^12 + x^11 + x^10 + x^8 + x^3 + x^2 + x\n69824286833704501471834043923417254326103912707315595840737453739249974863266259092449058810542265536810346421685955365128856715192808287450464619418781355923155781710833586631897182535937891456025282049302526058466298304955387306232279075295308862156912873485647349272079984781574084434511227361370780842056</code></pre></div>\n<h2>Solution</h2>\n<h3>Finite Fields of Prime Power Order</h3>\n<p>The key and the parameters to the cipher in the challenge are elements of the finite field <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mn>256</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">GF(2^{256})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">GF</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">256</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>. This field is constructed by taking the quotient ring <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">GF(2)[x]/(P)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">GF</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span></span></span></span></span> for some irreducible polynomial <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span> of degree 256. Elements of <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mn>256</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">GF(2^{256})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">GF</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">256</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span> can be thought of as polynomials with coefficients in <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mi>F</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">GF(2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">GF</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span></span> reduced modulo <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>.</p>\n<h3>Challenge Analysis</h3>\n<p>The flag is encrypted by XORing the bits of the flag with the outputs of a PRG. The PRG is given a secret key <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>∈</mo><mi>G</mi><mi>F</mi><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mn>256</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">k \\in GF(2^{256})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">GF</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">256</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span> and public parameters <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo>∈</mo><mi>G</mi><mi>F</mi><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mn>256</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a, b \\in GF(2^{256})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">GF</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">256</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span> and derives random bits from the terms of <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><msup><mi>a</mi><mi>i</mi></msup><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">ka^i + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.907994em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span> with degree less than 10. Specifically, the <code>xbit</code> is the sum of the coefficients of the even degree terms, and the <code>ybit</code> is the product of the coefficients of the odd degree terms.</p>\n<p>The flag is padded by 768 zero bits which gives us some information about the PRG output. Since the <code>ybit</code> is a product of 5 terms, it is going to be zero most of the time. This means, we can more or less assume that the PRG output is just <code>xbit</code>.</p>\n<h3>Recovering the Key</h3>\n<p>Assuming we have 768 bits of the PRG output, how can we recover the key? The key thing to notice is that the values from the sequence are very linear. We can represent each <code>xbit</code> as a linear equation of the coefficients of the key. To do this, we represented the key symbolically and found expressions for each of the first 768 <code>xbit</code>s in terms of the key.</p>\n<p>I'm sure there's a better way, but here's how we did it with Sage:</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">P<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>t<span class=\"token operator\">></span> <span class=\"token operator\">=</span> PolynomialRing<span class=\"token punctuation\">(</span>GF<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nKr <span class=\"token operator\">=</span> PolynomialRing<span class=\"token punctuation\">(</span>GF<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string-interpolation\"><span class=\"token string\">f'k</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>i<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nq <span class=\"token operator\">=</span> P<span class=\"token punctuation\">.</span>irreducible_element<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'minimal_weight'</span><span class=\"token punctuation\">)</span>\nT<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>y<span class=\"token operator\">></span> <span class=\"token operator\">=</span> PolynomialRing<span class=\"token punctuation\">(</span>Kr<span class=\"token punctuation\">)</span>\nR<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>x<span class=\"token operator\">></span> <span class=\"token operator\">=</span> T<span class=\"token punctuation\">.</span>quo<span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span>\n\na <span class=\"token operator\">=</span> x<span class=\"token operator\">^</span><span class=\"token number\">255</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">252</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">246</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">245</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">240</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">239</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">236</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">234</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">233</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">232</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">231</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">229</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">228</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">227</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">224</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">223</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">218</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">217</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">216</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">215</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">210</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">209</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">204</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">202</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">200</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">198</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">197</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">196</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">192</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">188</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">187</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">182</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">181</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">180</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">178</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">177</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">176</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">174</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">173</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">172</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">167</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">166</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">161</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">160</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">157</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">155</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">154</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">151</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">150</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">149</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">148</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">147</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">146</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">144</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">140</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">137</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">135</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">133</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">132</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">130</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">129</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">126</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">122</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">119</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">118</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">115</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">112</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">111</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">109</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">107</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">106</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">105</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">104</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">101</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">100</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">99</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">97</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">96</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">94</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">92</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">87</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">86</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">84</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">83</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">81</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">79</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">75</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">71</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">69</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">68</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">67</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">66</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">65</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">63</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">62</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">61</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">56</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">55</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">53</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">52</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">50</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">46</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">44</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">43</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">41</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">39</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">38</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">37</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">36</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">35</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">34</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">33</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">32</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">30</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">29</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">27</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">24</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">21</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">17</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">16</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">14</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">13</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">12</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">11</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">9</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">5</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">4</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">3</span> <span class=\"token operator\">+</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> x<span class=\"token operator\">^</span><span class=\"token number\">255</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">254</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">250</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">247</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">243</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">242</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">241</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">238</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">235</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">232</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">229</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">227</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">222</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">221</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">219</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">218</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">217</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">216</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">215</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">211</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">207</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">206</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">204</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">202</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">201</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">197</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">195</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">193</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">192</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">190</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">189</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">188</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">186</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">184</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">181</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">180</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">179</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">178</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">176</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">173</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">172</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">169</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">167</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">165</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">161</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">160</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">158</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">149</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">147</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">146</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">145</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">140</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">138</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">137</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">134</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">133</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">132</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">130</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">129</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">128</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">126</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">125</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">124</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">121</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">120</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">118</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">117</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">114</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">112</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">111</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">110</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">109</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">108</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">107</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">106</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">105</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">101</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">96</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">95</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">94</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">93</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">92</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">90</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">89</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">88</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">86</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">85</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">84</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">83</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">81</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">80</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">79</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">78</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">77</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">76</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">71</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">70</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">69</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">68</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">67</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">64</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">63</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">59</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">56</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">55</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">53</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">50</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">46</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">43</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">42</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">40</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">38</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">37</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">35</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">34</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">33</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">25</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">23</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">22</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">21</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">18</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">16</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">14</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">13</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">12</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">11</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">8</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">3</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> x\n\nkey <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>k<span class=\"token operator\">*</span>x<span class=\"token operator\">^</span>i <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span>k <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>Kr<span class=\"token punctuation\">.</span>gens<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nkvars <span class=\"token operator\">=</span> Kr<span class=\"token punctuation\">.</span>gens<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">768</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    key <span class=\"token operator\">=</span> key<span class=\"token operator\">*</span>a\n    value <span class=\"token operator\">=</span> key <span class=\"token operator\">+</span> b\n    xi <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    g <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>kvars<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> xi<span class=\"token punctuation\">.</span>variables<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Once we have these expressions, we have enough information to solve the system of linear equations to recover the key. But not all of the equations we found will be true as we assumed the <code>ybit</code> will always be zero, when in fact it will only be zero most of the time. Luckily, we have 768 equations and we only need 256, so we can continually randomly pick 256 equations and see if we get a solution with those. When we choose 256 equations that all hold true, we should be able to solve the system and decrypt the flag.</p>\n<p>To solve the system of equations, we write each expression as rows of a <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>256</mn><mo>×</mo><mn>256</mn></mrow><annotation encoding=\"application/x-tex\">256 \\times 256</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">256</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">256</span></span></span></span></span> matrix <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span></span> and compute <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">A^{-1} \\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span></span>, where <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.44444em;vertical-align:0em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span></span> is the corresponding <code>xbit</code>s vector.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">from</span> random <span class=\"token keyword\">import</span> sample\n<span class=\"token keyword\">from</span> tqdm <span class=\"token keyword\">import</span> tqdm\n<span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> long_to_bytes\n\nP<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>x<span class=\"token operator\">></span> <span class=\"token operator\">=</span> PolynomialRing<span class=\"token punctuation\">(</span>GF<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nq <span class=\"token operator\">=</span> P<span class=\"token punctuation\">.</span>irreducible_element<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'minimal_weight'</span><span class=\"token punctuation\">)</span>\nR<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>x<span class=\"token operator\">></span> <span class=\"token operator\">=</span> P<span class=\"token punctuation\">.</span>quo<span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Cipher</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> size\n        self<span class=\"token punctuation\">.</span>params <span class=\"token operator\">=</span> params\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">sequence</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n            key <span class=\"token operator\">=</span> key <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">yield</span> key <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> strength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> value<span class=\"token punctuation\">,</span> pbit <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>sequence<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            xbit <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> strength<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            ybit <span class=\"token operator\">=</span> mul<span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> strength<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            \n            <span class=\"token keyword\">yield</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>pbit<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span><span class=\"token operator\">^</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>xbit<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span><span class=\"token operator\">^</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>ybit<span class=\"token punctuation\">)</span>\n\na <span class=\"token operator\">=</span> x<span class=\"token operator\">^</span><span class=\"token number\">255</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">252</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">246</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">245</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">240</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">239</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">236</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">234</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">233</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">232</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">231</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">229</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">228</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">227</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">224</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">223</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">218</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">217</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">216</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">215</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">210</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">209</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">204</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">202</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">200</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">198</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">197</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">196</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">192</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">188</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">187</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">182</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">181</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">180</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">178</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">177</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">176</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">174</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">173</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">172</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">167</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">166</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">161</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">160</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">157</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">155</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">154</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">151</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">150</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">149</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">148</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">147</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">146</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">144</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">140</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">137</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">135</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">133</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">132</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">130</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">129</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">126</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">122</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">119</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">118</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">115</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">112</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">111</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">109</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">107</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">106</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">105</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">104</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">101</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">100</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">99</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">97</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">96</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">94</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">92</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">87</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">86</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">84</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">83</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">81</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">79</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">75</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">71</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">69</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">68</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">67</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">66</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">65</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">63</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">62</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">61</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">56</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">55</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">53</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">52</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">50</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">46</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">44</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">43</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">41</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">39</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">38</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">37</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">36</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">35</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">34</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">33</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">32</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">30</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">29</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">27</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">24</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">21</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">17</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">16</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">14</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">13</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">12</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">11</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">9</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">5</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">4</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">3</span> <span class=\"token operator\">+</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> x<span class=\"token operator\">^</span><span class=\"token number\">255</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">254</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">250</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">247</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">243</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">242</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">241</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">238</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">235</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">232</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">229</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">227</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">222</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">221</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">219</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">218</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">217</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">216</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">215</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">211</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">207</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">206</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">204</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">202</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">201</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">197</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">195</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">193</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">192</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">190</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">189</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">188</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">186</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">184</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">181</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">180</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">179</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">178</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">176</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">173</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">172</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">169</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">167</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">165</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">161</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">160</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">158</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">149</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">147</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">146</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">145</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">140</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">138</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">137</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">134</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">133</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">132</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">130</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">129</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">128</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">126</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">125</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">124</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">121</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">120</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">118</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">117</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">114</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">112</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">111</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">110</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">109</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">108</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">107</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">106</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">105</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">101</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">96</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">95</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">94</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">93</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">92</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">90</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">89</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">88</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">86</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">85</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">84</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">83</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">81</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">80</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">79</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">78</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">77</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">76</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">71</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">70</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">69</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">68</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">67</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">64</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">63</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">59</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">56</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">55</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">53</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">50</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">46</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">43</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">42</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">40</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">38</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">37</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">35</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">34</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">33</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">25</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">23</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">22</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">21</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">18</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">16</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">14</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">13</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">12</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">11</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">8</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">3</span> <span class=\"token operator\">+</span> x<span class=\"token operator\">^</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> x\nresult <span class=\"token operator\">=</span> <span class=\"token number\">69824286833704501471834043923417254326103912707315595840737453739249974863266259092449058810542265536810346421685955365128856715192808287450464619418781355923155781710833586631897182535937891456025282049302526058466298304955387306232279075295308862156912873485647349272079984781574084434511227361370780842056</span>\nciphertext <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">bin</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nknowns <span class=\"token operator\">=</span> ciphertext<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">768</span><span class=\"token punctuation\">]</span>\n\neqns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> l <span class=\"token keyword\">in</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'eqns'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>splitlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">eqn_to_vec</span><span class=\"token punctuation\">(</span>eq<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    v <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">256</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> eq<span class=\"token punctuation\">:</span>\n        v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">return</span> v\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">vec_to_poly</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span>c <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        p <span class=\"token operator\">+=</span> c<span class=\"token operator\">*</span>x<span class=\"token operator\">^</span>i\n    <span class=\"token keyword\">return</span> p\n\nCs <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>eqn_to_vec<span class=\"token punctuation\">,</span> eqns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> knowns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> tqdm<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">133333337</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    E <span class=\"token operator\">=</span> sample<span class=\"token punctuation\">(</span>Cs<span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>\n    A <span class=\"token operator\">=</span> Matrix<span class=\"token punctuation\">(</span>GF<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> e <span class=\"token keyword\">in</span> E<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    v <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>GF<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> e <span class=\"token keyword\">in</span> E<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> A<span class=\"token punctuation\">.</span>is_singular<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">continue</span>\n    sol <span class=\"token operator\">=</span>  A<span class=\"token operator\">^</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">*</span> v\n    key <span class=\"token operator\">=</span> vec_to_poly<span class=\"token punctuation\">(</span>sol<span class=\"token punctuation\">)</span>\n    cipher <span class=\"token operator\">=</span> Cipher<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    pt <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>cipher<span class=\"token punctuation\">.</span>encrypt<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> ciphertext<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token number\">1</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> pt<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">768</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        flag <span class=\"token operator\">=</span> long_to_bytes<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> pt<span class=\"token punctuation\">[</span><span class=\"token number\">768</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Flag: <code>Aero{n1c3_ISD_4tt4ck_g00d_j0b!!}</code></p>","frontmatter":{"date":"February 28, 2021","path":"/posts/2021-02-28-aero-ctf-2021-phoenix","title":"Aero CTF 2021 - phoenix","tags":"ctf,infosec,writeup,crypto"}}},"pageContext":{"prev":{"fileAbsolutePath":"/media/winarch-shared/code/portfolio/src/posts/2021-02-08-dicectf-2021-garbled/index.md","frontmatter":{"title":"DiceCTF 2021 - garbled","date":"2021-02-08T00:00:00.000Z","path":"/posts/2021-02-08-dicectf-2021-garbled"}},"next":{"fileAbsolutePath":"/media/winarch-shared/code/portfolio/src/posts/2021-03-07-zer0pts-ctf-2021-crypto-writeups/index.md","frontmatter":{"title":"zer0pts CTF 2021 - Crypto","date":"2021-03-07T00:00:00.000Z","path":"/posts/2021-03-07-zer0pts-ctf-2021-crypto-writeups"}}}},
    "staticQueryHashes": ["63159454"]}